<div class="leave-approvals-container">
  <section class="page-head">
    <div>
      <h1>Leave & WFH Approvals</h1>
      <p>Review pending requests and take action quickly.</p>
    </div>
    <div class="head-badges">
      <span class="badge">{{ leaveRequests.length }} Leave Pending</span>
      <span class="badge">{{ wfhRequests.length }} WFH Pending</span>
    </div>
  </section>

  <!-- TABS -->
  <div class="tabs">
    <button
      class="tab-btn"
      [class.active]="activeTab === 'leave'"
      (click)="setTab('leave')"
    >
      Leave Requests
    </button>
    <button
      class="tab-btn"
      [class.active]="activeTab === 'wfh'"
      (click)="setTab('wfh')"
    >
      WFH Requests
    </button>
  </div>

  <!-- LEAVE TAB -->
  <section class="panel" *ngIf="activeTab === 'leave'">
    <h2>Pending Leave Requests</h2>

    <p class="error" *ngIf="errorLeave">{{ errorLeave }}</p>

    <div class="loading" *ngIf="loadingLeave">Loading leave requests...</div>

    <div class="table-wrap" *ngIf="!loadingLeave && leaveRequests.length">
      <table class="table">
        <thead>
          <tr>
            <th>Employee</th>
            <th>Type</th>
            <th>From</th>
            <th>To</th>
            <th>Reason</th>
            <th>Status</th>
            <th>Requested On</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let req of leaveRequests">
            <td>
              <strong>{{ req.employee?.firstName }} {{ req.employee?.lastName }}</strong>
              <br />
              <small>{{ req.employee?.email }}</small>
            </td>
            <td>{{ req.type }}</td>
            <td>{{ req.from | date: 'mediumDate' }}</td>
            <td>{{ req.to | date: 'mediumDate' }}</td>
            <td>{{ req.reason || '-' }}</td>
            <td>
              <span class="status" [ngClass]="req.status?.toLowerCase()">
                {{ req.status }}
              </span>
            </td>
            <td>{{ req.createdAt | date: 'short' }}</td>
            <td>
              <button class="btn approve" (click)="approveLeave(req)">Approve</button>
              <button class="btn reject" (click)="rejectLeave(req)">Reject</button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="empty" *ngIf="!loadingLeave && !leaveRequests.length">
      <p>No pending leave requests.</p>
    </div>
  </section>

  <!-- WFH TAB -->
  <section class="panel" *ngIf="activeTab === 'wfh'">
    <h2>Pending WFH Requests</h2>

    <p class="error" *ngIf="errorWfh">{{ errorWfh }}</p>

    <div class="loading" *ngIf="loadingWfh">Loading WFH requests...</div>

    <div class="table-wrap" *ngIf="!loadingWfh && wfhRequests.length">
      <table class="table">
        <thead>
          <tr>
            <th>Employee</th>
            <th>From</th>
            <th>To</th>
            <th>Reason</th>
            <th>Status</th>
            <th>Requested On</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let req of wfhRequests">
            <td>
              <strong>{{ req.employee?.firstName }} {{ req.employee?.lastName }}</strong>
              <br />
              <small>{{ req.employee?.email }}</small>
            </td>
            <td>{{ req.from | date: 'mediumDate' }}</td>
            <td>{{ req.to | date: 'mediumDate' }}</td>
            <td>{{ req.reason || '-' }}</td>
            <td>
              <span class="status" [ngClass]="req.status?.toLowerCase()">
                {{ req.status }}
              </span>
            </td>
            <td>{{ req.createdAt | date: 'short' }}</td>
            <td>
              <button class="btn approve" (click)="approveWfh(req)">Approve</button>
              <button class="btn reject" (click)="rejectWfh(req)">Reject</button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="empty" *ngIf="!loadingWfh && !wfhRequests.length">
      <p>No pending WFH requests.</p>
    </div>
  </section>
</div>
