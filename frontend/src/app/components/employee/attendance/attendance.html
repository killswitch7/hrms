<div class="attendance-container">
  <h1>My Attendance</h1>

  <!-- TODAY CARD -->
  <div class="card today-card">
    <h2>Today: {{ todayString }}</h2>

    <p *ngIf="todayRecord">
      Check-in:
      <strong>{{ todayRecord.checkIn | date: 'shortTime' }}</strong>
      <br />
      Check-out:
      <strong>
        {{ todayRecord.checkOut ? (todayRecord.checkOut | date: 'shortTime') : '-' }}
      </strong>
    </p>

    <p *ngIf="!todayRecord">
      No attendance record for today yet.
    </p>

    <div class="actions">
      <button
        type="button"
        class="btn"
        (click)="onCheckIn()"
        [disabled]="loading || hasCheckedInToday"
      >
        {{ hasCheckedInToday ? 'Already Checked In' : 'Check In' }}
      </button>

      <button
        type="button"
        class="btn secondary"
        (click)="onCheckOut()"
        [disabled]="loading || !hasCheckedInToday || hasCheckedOutToday"
      >
        {{ hasCheckedOutToday ? 'Already Checked Out' : 'Check Out' }}
      </button>
    </div>

    <p class="error" *ngIf="error">{{ error }}</p>
    <p class="success" *ngIf="success">{{ success }}</p>
  </div>

  <!-- HISTORY CARD -->
  <div class="card history-card">
    <h2>Last 30 Days</h2>

    <div *ngIf="loading && !records.length">
      Loading attendance...
    </div>

    <div *ngIf="!loading && !records.length">
      <p>No attendance records found.</p>
    </div>

    <table *ngIf="records.length" class="attendance-table">
      <thead>
        <tr>
          <th>Date</th>
          <th>Check-In</th>
          <th>Check-Out</th>
          <th>Status</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let r of records">
          <td>{{ r.date | date: 'mediumDate' }}</td>
          <td>{{ r.checkIn ? (r.checkIn | date: 'shortTime') : '-' }}</td>
          <td>{{ r.checkOut ? (r.checkOut | date: 'shortTime') : '-' }}</td>
          <td>{{ r.status || 'Present' }}</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
