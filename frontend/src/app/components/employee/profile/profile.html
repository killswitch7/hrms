<div class="profile-shell">
  <mat-card class="profile-card">
    <div class="avatar-block">
      <label class="avatar-wrap" for="employeeProfileAvatarInput">
        <img *ngIf="avatarUrl; else fallback" [src]="avatarUrl" alt="Employee photo" />
        <ng-template #fallback>
          <mat-icon>person</mat-icon>
        </ng-template>
      </label>
      <input
        id="employeeProfileAvatarInput"
        class="hidden-input"
        type="file"
        accept="image/*"
        (change)="onAvatarSelected($event)"
      />
      <div class="avatar-actions">
        <label for="employeeProfileAvatarInput" class="upload-label">Upload Photo</label>
        <button mat-button color="warn" *ngIf="avatarUrl" (click)="removeAvatar()">Remove</button>
      </div>
    </div>

    <div class="details">
      <h2>My Profile</h2>
      <p class="error" *ngIf="error">{{ error }}</p>
      <div class="row"><label>Name</label><span>{{ profile.name }}</span></div>
      <div class="row"><label>Email</label><span>{{ profile.email }}</span></div>
      <div class="row"><label>Employee ID</label><span>{{ profile.employeeId }}</span></div>
      <div class="row"><label>Position</label><span>{{ profile.position }}</span></div>
      <div class="row"><label>Department</label><span>{{ profile.department }}</span></div>
      <div class="row"><label>Phone</label><span>{{ profile.phone || '-' }}</span></div>
      <div class="row"><label>Join Date</label><span>{{ profile.joinDate | date:'longDate' }}</span></div>

      <div class="profile-actions">
        <a class="link-btn" routerLink="/edit-profile">Edit Profile</a>
        <a class="link-btn" routerLink="/change-password">Change Password</a>
      </div>

      <div class="sub-card">
        <h3>Leave Info</h3>
        <div class="row"><label>Annual Allowance</label><span>{{ leaveInfo.annualAllowance }} days</span></div>
        <div class="row"><label>Used</label><span>{{ leaveInfo.used }} days</span></div>
        <div class="row"><label>Remaining</label><span>{{ leaveInfo.remaining }} days</span></div>
      </div>

      <div class="sub-card">
        <h3>Salary Info</h3>
        <div class="row"><label>Annual Salary</label><span>{{ salaryInfo.annualSalary | currency:'NPR':'symbol':'1.0-0' }}</span></div>
        <div class="row"><label>Monthly Before Tax</label><span>{{ salaryInfo.monthlyBeforeTax | currency:'NPR':'symbol':'1.0-0' }}</span></div>
        <div class="row"><label>Filing Status</label><span>{{ salaryInfo.filingStatus }}</span></div>
        <div class="row"><label>Latest Payroll Month</label><span>{{ salaryInfo.latestMonth || '-' }}</span></div>
        <div class="row"><label>Latest Gross</label><span>{{ salaryInfo.latestGrossPay ? (salaryInfo.latestGrossPay | currency:'NPR':'symbol':'1.0-0') : '-' }}</span></div>
        <div class="row"><label>Latest Tax</label><span>{{ salaryInfo.latestTax ? (salaryInfo.latestTax | currency:'NPR':'symbol':'1.0-0') : '-' }}</span></div>
        <div class="row"><label>Latest Deductions</label><span>{{ salaryInfo.latestDeductions ? (salaryInfo.latestDeductions | currency:'NPR':'symbol':'1.0-0') : '-' }}</span></div>
        <div class="row"><label>Latest Net Pay</label><span>{{ salaryInfo.latestNetPay ? (salaryInfo.latestNetPay | currency:'NPR':'symbol':'1.0-0') : '-' }}</span></div>
        <div class="row"><label>Payroll Status</label><span>{{ salaryInfo.latestStatus || '-' }}</span></div>
      </div>
    </div>
  </mat-card>
</div>
